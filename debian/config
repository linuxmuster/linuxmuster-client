#!/bin/sh

# 11.07.2009

# Source debconf library.
. /usr/share/debconf/confmodule

# source config
[ -e /etc/linuxmuster-client/config ] && . /etc/linuxmuster-client/config

db_version 2.0
db_capb backup

PRIORITY="critical"

db_title "linuxmuster-client Konfiguration"

# ldap server uri
db_get ldap-auth-config/ldapns/ldap-server || true
db_set shared/ldapns/ldap-server ${RET#*\/\/} || true
while [ -z "$INPUT" ]; do
  db_input $PRIORITY shared/ldapns/ldap-server || true
  db_go
  db_get shared/ldapns/ldap-server || true
  INPUT=$RET
done
db_set ldap-auth-config/ldapns/ldap-server $INPUT || true

# ldap basedn
unset INPUT
db_get ldap-auth-config/ldapns/base-dn || true
db_set shared/ldapns/base-dn $RET || true
while [ -z "$INPUT" ]; do
  db_input $PRIORITY shared/ldapns/base-dn || true
  db_go
  db_get shared/ldapns/base-dn || true
  INPUT=$RET
done
db_set ldap-auth-config/ldapns/base-dn $INPUT || true

# template user
db_set linuxmuster-client/template_user $TEMPLATE_USER || true
db_input $PRIORITY linuxmuster-client/template_user || true
db_go

# firefox
[ -n "$FIREFOX" ] && FIREFOX=`echo $FIREFOX | tr A-Z a-z`
if [ "$FIREFOX" = "yes" ]; then
 db_set linuxmuster-client/firefox true || true
else
 db_set linuxmuster-client/firefox false || true
fi
db_input $PRIORITY linuxmuster-client/firefox || true
db_go

# finish debconf stuff
db_stop

